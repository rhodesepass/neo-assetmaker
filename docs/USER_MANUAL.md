# 用户手册

## 目录

1. [快速开始](#快速开始)
2. [项目管理](#项目管理)
3. [视频处理](#视频处理)
4. [图像处理](#图像处理)
5. [配置管理](#配置管理)
6. [导出功能](#导出功能)
7. [固件烧录](#固件烧录)
8. [自动保存](#自动保存)
9. [崩溃恢复](#崩溃恢复)
10. [快捷键](#快捷键)
11. [常见问题](#常见问题)

---

## 快速开始

### 安装

1. 下载最新版本的安装程序
2. 运行安装程序，按照提示完成安装
3. 启动程序

### 创建第一个项目

1. 启动程序后，会自动创建临时项目
2. 在"基础设置"面板中配置项目
3. 点击"保存"按钮保存项目

---

## 项目管理

### 新建项目

- **菜单**: 文件 → 新建项目
- **快捷键**: `Ctrl+N`

### 打开项目

- **菜单**: 文件 → 打开项目
- **快捷键**: `Ctrl+O`
- **最近文件**: 文件 → 最近打开

### 保存项目

- **菜单**: 文件 → 保存
- **快捷键**: `Ctrl+S`

### 另存为

- **菜单**: 文件 → 另存为
- **快捷键**: `Ctrl+Shift+S`

---

## 视频处理

### 循环视频

循环视频是通行证的主要内容，会循环播放。

#### 设置循环视频

1. 在"基础设置"面板中找到"循环视频"部分
2. 点击"选择文件"按钮选择视频文件
3. 配置视频参数：
   - **入点**: 循环开始位置（帧数）
   - **出点**: 循环结束位置（帧数）
   - **播放速度**: 播放速度倍率

#### 预览循环视频

1. 选择视频文件后，会自动加载到预览器
2. 使用播放控制按钮控制播放
3. 拖动时间轴设置入点和出点

### 入场视频

入场视频是通行证开始时播放的动画。

#### 设置入场视频

1. 在"基础设置"面板中找到"入场视频"部分
2. 勾选"启用入场视频"
3. 点击"选择文件"按钮选择视频文件
4. 配置入场参数：
   - **入场时长**: 入场动画持续时间（秒）
   - **淡入时长**: 淡入效果持续时间（秒）

#### 预览入场视频

1. 选择视频文件后，会自动加载到预览器
2. 使用播放控制按钮控制播放

---

## 图像处理

### 循环图片

如果使用图片作为循环内容，可以配置循环图片。

#### 设置循环图片

1. 在"基础设置"面板中找到"循环视频"部分
2. 勾选"使用图片模式"
3. 点击"选择图片"按钮选择图片文件
4. 配置图片参数：
   - **缩放**: 图片缩放比例
   - **位置**: 图片位置（X, Y）

### 叠加图片

叠加图片是显示在通行证上的额外图片。

#### 设置叠加图片

1. 在"高级设置"面板中找到"叠加图片"部分
2. 点击"选择图片"按钮选择图片文件
3. 配置叠加参数：
   - **位置**: 叠加图片位置（X, Y）
   - **缩放**: 叠加图片缩放比例
   - **透明度**: 叠加图片透明度（0-100）

---

## 配置管理

### 基础配置

基础配置提供了简化的界面，适合快速配置。

#### 可配置项

- **循环视频**: 循环内容设置
- **入场视频**: 入场动画设置
- **叠加图片**: 叠加图片设置

### 高级配置

高级配置提供了完整的配置选项。

#### 可配置项

- **循环视频**: 完整的循环视频设置
- **入场视频**: 完整的入场视频设置
- **转场效果**: 转场效果设置
- **叠加图片**: 叠加图片设置
- **文本叠加**: 文本叠加设置

### JSON配置

JSON配置提供了直接编辑配置文件的方式。

#### 使用JSON配置

1. 在"预览"标签页中查看JSON配置
2. 直接编辑JSON内容
3. 配置会自动应用到项目

---

## 导出功能

### 导出通行证

将配置导出为通行证素材。

#### 导出步骤

1. 配置完成后，点击"导出"按钮
2. 选择导出目录
3. 等待导出完成
4. 导出的文件会保存在指定目录

#### 导出内容

- 循环视频/图片
- 入场视频
- 叠加图片
- 配置文件

---

## 固件烧录

### 启动固件烧录工具

- **侧边栏**: 点击侧边栏中的固件烧录图标
- **菜单**: 工具 → 固件烧录（备用方式）
- **快捷键**: 无

### 烧录步骤

1. 连接方舟EPASS设备到电脑
2. 通过侧边栏导航进入固件烧录界面
3. 选择固件文件
4. 点击"开始烧录"按钮
5. 等待烧录完成

### 更新固件

固件烧录工具支持自动更新固件到最新版本。

#### 更新步骤

1. 在固件烧录工具中点击"更新固件"按钮
2. 确认更新操作
3. 等待下载和更新完成
4. 更新完成后重新启动设备

---

## 自动保存

### 自动保存功能

程序会自动保存项目，防止数据丢失。

#### 自动保存设置

- **保存间隔**: 默认5分钟
- **最大备份数**: 默认5个

#### 备份位置

备份文件保存在项目目录的`.autosave`文件夹中。

#### 备份文件命名

备份文件命名格式：`backup_YYYYMMDD_HHMMSS.json`

---

## 崩溃恢复

### 崩溃恢复功能

如果程序意外关闭，重新启动时会检查是否有未保存的项目。

### 恢复步骤

1. 重新启动程序
2. 如果发现未保存的项目，会弹出恢复对话框
3. 在恢复对话框中选择要恢复的项目
4. 点击"恢复"按钮
5. 选择恢复位置
6. 等待恢复完成

### 恢复选项

- **恢复到原位置**: 恢复到原来的项目位置
- **恢复到新位置**: 选择新的保存位置
- **删除恢复信息**: 删除恢复信息，不恢复

---

## 快捷键

### 文件操作

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+N` | 新建项目 |
| `Ctrl+O` | 打开项目 |
| `Ctrl+S` | 保存项目 |
| `Ctrl+Shift+S` | 另存为 |
| `Ctrl+Q` | 退出程序 |

### 编辑操作

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+Z` | 撤销 |
| `Ctrl+Y` | 重做 |

### 播放控制

| 快捷键 | 功能 |
|--------|------|
| `Space` | 播放/暂停 |
| `←` | 上一帧 |
| `→` | 下一帧 |
| `Home` | 跳到开始 |
| `End` | 跳到结束 |

### 帮助

| 快捷键 | 功能 |
|--------|------|
| `F1` | 快捷键帮助 |

---

## 常见问题

### Q: 程序无法启动？

**A**: 请检查以下几点：
1. 确认已安装所有依赖
2. 检查是否有防火墙阻止
3. 尝试以管理员身份运行

### Q: 视频无法加载？

**A**: 请检查以下几点：
1. 确认视频文件格式正确（支持MP4, AVI, MOV等）
2. 检查视频文件是否损坏
3. 尝试使用其他视频文件

### Q: 导出失败？

**A**: 请检查以下几点：
1. 确认导出目录有写入权限
2. 检查磁盘空间是否充足
3. 确认配置文件格式正确

### Q: 固件烧录失败？

**A**: 请检查以下几点：
1. 确认设备已正确连接
2. 检查驱动是否正确安装
3. 确认固件文件完整
4. 尝试重新连接设备

### Q: 如何查看错误详情？

**A**: 当发生错误时，错误对话框会显示：
1. 用户友好的错误消息
2. 解决建议
3. 技术详情（点击"详情"按钮查看）

### Q: 如何配置自动保存？

**A**: 自动保存配置在程序内部设置：
- 保存间隔：默认5分钟
- 最大备份数：默认5个

如需修改，请修改程序源代码中的`AutoSaveConfig`配置。

### Q: 如何禁用自动保存？

**A**: 自动保存目前无法在界面中禁用。如需禁用，请修改程序源代码中的`AutoSaveConfig`配置，将`enabled`设置为`False`。

### Q: 崩溃恢复在哪里？

**A**: 崩溃恢复信息保存在程序目录的`.recovery`文件夹中。

### Q: 如何清空最近文件列表？

**A**: 在"文件"菜单中，选择"最近打开" → "清空最近文件"。

### Q: 程序支持哪些视频格式？

**A**: 程序支持以下视频格式：
- MP4 (推荐）
- AVI
- MOV
- MKV
- WMV

### Q: 如何联系技术支持？

**A**: 如需技术支持，请：
1. 查看GitHub Issues: https://github.com/lxfebd/neo-assetmaker/issues
2. 提交问题时，请提供：
   - 程序版本
   - 操作系统版本
   - 错误详情
   - 复现步骤

---

## 更新日志

### v2.3.0

#### 新增功能

- ✨ 无边框UI界面 - 实现了完全无边框的现代化UI设计，自定义标题栏
- ✨ 固件烧录界面集成 - 将固件烧录工具从独立窗口集成到主UI界面
- ✨ 窗口管理增强 - 美化了窗口控制按钮，添加了窗口大小调整功能
- ✨ 窗口边缘检测 - 提供直观的光标反馈，方便调整窗口大小
- ✨ 窗口拖动功能 - 支持通过拖动标题栏移动窗口
- ✨ QFluentWidgets库集成 - 使用现代化的UI组件，提升界面美观度

#### 改进

- 🎨 美化窗口控制按钮，采用圆形设计
- 🎨 UI重构 - 全新的三栏布局设计，侧边栏导航系统
- 🚀 优化窗口大小调整的实现
- 📦 清理代码中的未使用导入和变量
- ✅ 使用autopep8格式化代码，确保代码风格一致

#### 架构变更

- 无边框UI界面设计，使用自定义标题栏
- 固件烧录工具集成到主UI界面，通过侧边栏访问
- 使用QFluentWidgets库提供现代化的UI组件
- 全新的三栏布局：配置面板 + 视频预览 + JSON预览
- 侧边栏导航系统，包含固件烧录、素材制作、素材商城、项目介绍、设置等模块

### v2.1.0

#### 新增功能

- ✨ 基础设置模式优化 - 首页默认显示基础界面，简化用户操作流程
- ✨ 标签页管理优化 - 基础模式下只显示循环视频标签页，避免用户看到黑屏的不相关标签页

#### 改进

- 🎨 明日方舟模板干员信息优化 - 修复了干员名称不显示的问题
- 🚀 基础配置面板视频预览优化 - 修复了视频和图片文件选择后预览黑屏的问题
- 🐛 修复了GitHub Actions构建相关的问题

### v2.0.0

#### 新增功能

- ✨ 自动保存功能 - 定期保存项目配置
- ✨ 崩溃恢复功能 - 检测未保存的临时文件
- ✨ 错误处理增强 - 用户友好的错误提示
- ✨ 快捷键支持 - 提高操作效率
- ✨ 撤销/重做功能 - 方便修改配置
- ✨ 最近文件列表 - 快速打开最近项目
- ✨ 日志系统增强 - 支持日志轮转和搜索

#### 改进

- 🎨 优化用户界面
- 🚀 提升性能
- 🐛 修复已知问题

---

## 许可证

本项目采用 MIT 许可证。